@startuml class-testharness
skinparam classAttributeIconSize 0
skinparam shadowing false
skinparam linetype ortho
skinparam dpi 300
left to right direction
scale 1.5

' === Test Harness Core ===
class ProblemTest<TInput, TOutput> {
    - _solver: Func
    - _comparer: Func
    - _problemName: string
    + RunTests(testCases: List<TestCase>): BenchmarkSummary
}
note right of ProblemTest
Executes test cases with optional validation and returns benchmark summary
end note

class TestCase {
    - Input: TInput
    - Expected: TOutput
    - ValidateBySum: bool
    - ValidateByCount: bool
}

class TestResult {
    - IsPass: bool
    - Input: TInput
    - Expected: TOutput
    - Actual: TOutput
    - TimeMicros: double
}

' === Benchmarking ===
interface IBenchmarkSummary {
    + ProblemName: string
    + StrategyName: string
    + Passed: int
    + Total: int
    + AvgTimeMicros: double
    + TotalTimeMicros: double
}

class BenchmarkSummary implements IBenchmarkSummary {
    + ProblemName: string
    + StrategyName: string
    + Passed: int
    + Total: int
    + AvgTimeMicros: double
    + TotalTimeMicros: double
}

class StrategyBenchmark<TInput, TOutput> {
    + Run(strategies, testCases, comparer, iterations): List<BenchmarkResult>
}

class BenchmarkResult {
    - StrategyName: string
    - AvgMicroseconds: double
    - IsCorrect: bool
}

' === Comparer Logic ===
class ComparerResolver {
    + GetComparer(problemType): Func<TOutput, TOutput, bool>
}

class ComparerHelper {
    + ArraysEqual()
    + TripletSetsEqual()
    + ValidateBySum()
}

' === Relationships ===
ProblemTest --> TestCase
ProblemTest --> TestResult
ProblemTest --> BenchmarkSummary
BenchmarkSummary --> IBenchmarkSummary
ProblemTest --> ComparerResolver
ComparerResolver --> ComparerHelper

StrategyBenchmark --> BenchmarkResult
StrategyBenchmark --> IProblemStrategy

@enduml